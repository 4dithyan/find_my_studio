{% include "Admin/header.html" %}
{% load static %}

<section class="site-section" id="section-payment">
    <div class="container">
        <div class="row justify-content-end"> <!-- Changed to justify-content-end to move right -->
            <div class="col-md-10"> <!-- Reduced width for proper centering -->
                <br><br><br><br>
                <h2 class="mb-5 heading text-center">All Payment Details</h2>

                <div class="card shadow p-3 mb-5 bg-white rounded" style="border: 2px solid #ddd;margin-left: 50px;"> <!-- Added border here -->
                    <div class="card-body">
                        <table class="table table-bordered table-striped text-center align-middle">
                            <thead class="table-primary">
                                <tr>
                                    <th>Sl.No</th>
                                    <th>Customer Name</th>
                                    <th>Customer Email</th>
                                    <th>Customer Phone</th>
                                    <th>Studio Name</th>
                                    <th>Studio Address</th>
                                    <th>Payment Date</th>
                                    <th>Required Date</th>
                                    <th>No. of Days</th>
                                    <th>Commission Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for payment in payments %}
                                <tr>
                                    <td>{{ forloop.counter }}</td>
                                    <td>{{ payment.requestid.customerid.customername|default:"N/A" }}</td>
                                    <td>{{ payment.requestid.customerid.email|default:"N/A" }}</td>
                                    <td>{{ payment.requestid.customerid.phone|default:"N/A" }}</td>
                                    <td>{{ payment.requestid.packageid.studioid.studioname|default:"N/A" }}</td>
                                    <td>{{ payment.requestid.packageid.studioid.address|default:"N/A" }}</td>
                                    <td>{{ payment.paymentdate }}</td>
                                    <td>{{ payment.requestid.requireddate }}</td>
                                    <td>{{ payment.requestid.noofdays }}</td>
                                    <td>
                                        <span class="text-primary" style="cursor: pointer;" 
                                            onclick="showPopup({{ payment.tamount }}, {{ payment.requestid.packageid.amount }}, {{ payment.iamount }}, {{ payment.requestid.aamount }})">
                                            ₹{{ payment.camount }}
                                        </span>
                                    </td>
                                    <td>{{ payment.status }}</td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="11" class="text-center">No payment details available.</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Popup Modal for Payment Amount Details -->
<div id="popupModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closePopup()">&times;</span>
        <h3 class="text-center">Payment Amount Details</h3>
        <p><strong>Package Amount:</strong> ₹<span id="packageAmount"></span></p>
        <p><strong>Initial Amount:</strong> ₹<span id="initialAmount"></span></p>
        <p><strong>Additional Amount:</strong> ₹<span id="additionalAmount"></span></p>
        <p><strong>Total Amount:</strong> ₹<span id="totalAmount"></span></p>
    </div>
</div>

<style>
    .modal {
        display: none;
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
    }

    .modal-content {
        background-color: #fff;
        padding: 30px;
        border-radius: 12px;
        width: 100%;
        max-width: 500px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }

    .close {
        position: absolute;
        top: 10px; right: 20px;
        font-size: 30px;
        color: #aaa;
        cursor: pointer;
    }

    .close:hover { color: black; }
    .footer{
        position: fixed;
        width: 100%;
        bottom: 0;
    }
</style>

<script>
function showPopup(totalAmount, packageAmount, initialAmount, additionalAmount) {
    document.getElementById("packageAmount").innerText = packageAmount;
    document.getElementById("initialAmount").innerText = initialAmount;
    document.getElementById("additionalAmount").innerText = additionalAmount;
    document.getElementById("totalAmount").innerText = totalAmount;
    document.getElementById("popupModal").style.display = "flex";
}

function closePopup() {
    document.getElementById("popupModal").style.display = "none";
}
</script>
</div>
<div class="footer">
    {% include "Admin/footer.html" %}
</div>
